SELECT TRANSACTION_DATE,
        DAYNAME(TRANSACTION_DATE) AS Day_name,
       CASE
       WHEN DAYNAME(TRANSACTION_DATE) IN ('Sat','Sun') THEN 'Weekend'
       ELSE 'Weekday'
       END AS Day_Classification,
       MONTHNAME(TRANSACTION_DATE) AS Month_Name,
       TRANSACTION_TIME,
  CASE
  WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:59' THEN 'Morning'
  WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '16:59:59' THEN 'Afternoon'
  WHEN TRANSACTION_TIME >= '17:00:00' THEN 'Evening'
  END AS Time_Bucket,
  HOUR(TRANSACTION_TIME) AS Hour_of_Day,
  STORE_LOCATION,
  product_category,
  product_detail,
  product_type,
  ---unit_price,
  ---transaction_qty,
 count(distinct transaction_id) as Num_of_Sales,
 sum (transaction_qty*unit_price) AS Revenue,
FROM BRIGHT.COFFEE.SHOP
group by all;
